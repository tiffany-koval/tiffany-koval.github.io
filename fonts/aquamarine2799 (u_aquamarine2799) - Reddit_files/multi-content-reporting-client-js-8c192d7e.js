import{_ as t,n as e,e as s,g as i}from"./shell-091aa980.js";import{F as n}from"./faceplate-tabgroup-8f82bf9b.js";import{F as a,S as o}from"./types-1cf35b8e.js";import{R as l}from"./helpers-093c3384.js";import{f as r}from"./post-0ac2732b.js";import{s as p,x as c}from"./icon-bd54b9fa.js";import"./faceplate-checkbox-input-0d714e7a.js";import"./faceplate-tabpanel-566b25ae.js";import"./faceplate-tablist-e4ab106e.js";import"./pageable-832f4cce.js";import"./post-d6ddae05.js";import"./checked-input-element-a967e016.js";import"./faceplate-input-1d78f8a0.js";import"./input-element-422d9934.js";import"./form-common-utils-52bc3cfc.js";var d;!function(t){t.ADDITION="addition",t.REMOVAL="removal"}(d||(d={}));let h=class extends p{get uncheckedInputs(){return this.querySelectorAll("faceplate-checkbox-input:not([checked])")}get allInputs(){return this.querySelectorAll("faceplate-checkbox-input")}get tabpanel(){return this.querySelector("faceplate-tabpanel")}get badges(){return this.querySelectorAll("temporary-tabgroup span[rpl] span")}get additionalContentInput(){return document.querySelector("#additional-content")}connectedCallback(){super.connectedCallback(),this.initEventListeners();const t=this.getRootNode().host?.closest("report-form");t&&(this.helpers=new l(t)),this.badges&&this.badges.forEach((t=>{t.closest("span.gap-xs")?.classList.remove("gap-xs"),t.classList.add("hidden")})),this.populateValues()}disconnectedCallback(){super.disconnectedCallback()}firstUpdated(){this.updateComplete.then((()=>{this.isFlexibleReporting&&this.updateFormState()}))}constructor(){super(),this.selectLimit=2,this.isFlexibleReporting=!1,this.initEventListeners=()=>{this.allInputs?.forEach((t=>{t.addEventListener("input",this.handleClick)}));this.querySelectorAll("temporary-tabgroup button")?.forEach((t=>{t.addEventListener("click",this.resetPanelScroll)}));this.querySelectorAll(".empty-state-button")?.forEach((t=>{t.addEventListener("click",this.toggleEmptyState)}))},this.resetPanelScroll=async()=>{await this.updateComplete,this.tabpanel?.scrollTo(0,0)},this.populateValues=()=>{const t=this.isFlexibleReporting?this.additionalContentInput?.getAttribute("value"):this.helpers?.getHiddenInputValue("additionalContent");if(!t)return;const e=t?.split(",");this.populateCheckboxSelections(e),this.populateBadgeCounts(e)},this.populateCheckboxSelections=t=>{const e=t.length===this.selectLimit;this.allInputs.forEach((s=>{t?.includes(s.getAttribute("data-value")??"")?s.checked=!0:e&&(s.disabled=!0)}))},this.populateBadgeCounts=t=>{const e=t.reduce(((t,e)=>r(e)?{...t,posts:t.posts+1}:e.startsWith("t1_")?{...t,comments:t.comments+1}:t),{posts:0,comments:0}),s=this.badges[0],i=this.badges[1];e.posts>0&&(s.parentElement?.parentElement?.parentElement?.classList.add("gap-xs"),s.classList.remove("hidden"),s.textContent=e.posts.toString()),e.comments>0&&(i.parentElement?.parentElement?.parentElement?.classList.add("gap-xs"),i.classList.remove("hidden"),i.textContent=e.comments.toString())},this.toggleEmptyState=t=>{const e=this.tabpanel,s=t.currentTarget.getAttribute("slot")?.split("-")[1];e?.setAttribute("pageindex",`${s}`)},this.disableAllUnchecked=()=>{this.uncheckedInputs.forEach((t=>{t.disabled=!0}))},this.enableAllUnchecked=()=>{this.uncheckedInputs.forEach((t=>{t.removeAttribute("disabled")}))},this.modifyList=(t,e)=>{if(!t)return{modificationType:d.ADDITION,newList:[e]};const s=t.split(",");return s.includes(e)?{modificationType:d.REMOVAL,newList:s.filter((t=>t!==e))}:{modificationType:d.ADDITION,newList:[...s,e]}},this.updateBadgeCounts=t=>{const e=this.querySelector("temporary-tabgroup [faceplate-tab-selected]")?.querySelector("span[rpl] span");if(!e)return;const s=Number(e.textContent),i=e.parentElement?.parentElement?.parentElement;t===d.ADDITION&&(i?.classList.add("gap-xs"),e.classList.remove("hidden"),e.textContent=`${s+1}`),t===d.REMOVAL&&(s-1==0&&(i?.classList.remove("gap-xs"),e.classList.add("hidden")),e.textContent=""+(s-1))},this.handleClick=async t=>{t.preventDefault(),t.stopPropagation();const e=t.currentTarget?.getAttribute("data-value")??"",s=this.isFlexibleReporting?this.additionalContentInput?.getAttribute("value")??"":this.helpers?.getHiddenInputValue("additionalContent")??"";if(!e)return;const{modificationType:i,newList:n}=this.modifyList(s,e);this.updateBadgeCounts(i),this.isFlexibleReporting?this.additionalContentInput?.setAttribute("value",n.toString()):this.helpers?.setHiddenInputValue("additionalContent",n.toString()),await this.updateComplete,this.isFlexibleReporting&&this.updateFormState(),n.length===this.selectLimit?this.disableAllUnchecked():s.split(",").length===this.selectLimit&&this.enableAllUnchecked()},this.updateFormState=()=>{const t=Array.from(this.uncheckedInputs,(t=>t.getAttribute("data-value")));this.dispatchEvent(i("report-tracking",{reportFlow:{flowOptionSelected:a.ADD_CONTENT,flowContent:this.additionalContentInput?.getAttribute("value")??"",flowOptionAvailable:t.toString()}})),this.dispatchEvent(i("update-report-form",{fieldName:o.ADDITIONAL_CONTENT,value:this.additionalContentInput?.getAttribute("value")??"",nextAction:{type:this.nextActionType,step:this.nextStep},button:{isDisabled:!1}}))}}render(){return c`<slot></slot>`}};t([e({type:Number,attribute:"select-limit"})],h.prototype,"selectLimit",void 0),t([e({type:Boolean,attribute:"is-flexible-reporting"})],h.prototype,"isFlexibleReporting",void 0),t([e({type:String,attribute:"data-nextaction"})],h.prototype,"nextActionType",void 0),t([e({type:String,attribute:"data-next-step"})],h.prototype,"nextStep",void 0),h=t([s("multi-content-wrapper")],h);let u=class extends n{connectedCallback(){super.connectedCallback(),this._events._events.delete("click"),this._events.define("click",(t=>{const e=t.composedPath();for(let t=0;t<e.length;t++){const s=e[t];if(s instanceof HTMLSpanElement){const t=this.getPageIndexFromSpanWrapper(s);if(0!==t){this.pageIndex=t;break}}}}))}};u=t([s("temporary-tabgroup")],u);
//# sourceMappingURL=multi-content-reporting-client-js-8c192d7e.js.map
