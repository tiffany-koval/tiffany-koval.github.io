import"./faceplate-expandable-section-helper-6547c632.js";import"./faceplate-shimmer-7a244724.js";import{W as t,f as e,l as i,f0 as a,aD as s,aE as r,q as o,g as d,k as n,a as l,b as c,c as h,_ as p,n as u,e as m,J as v,t as f}from"./shell-091aa980.js";import{x as g,r as F,I as S,bO as y,bP as b,s as N,aP as C}from"./icon-bd54b9fa.js";import{l as k,L as $}from"./list-item-87b32fd6.js";import{C as x,a as P}from"./index-254be96d.js";import"./custom-feed-edit-button-809b794e.js";let w=class extends(t(e(N))){constructor(){super(...arguments),this.multiredditPath="",this.displayName="",this.iconSrc="",this.isFavorited=!1,this.sanNoun="",this.getTrackingContext=()=>({customFeed:{id:this.multiredditPath}}),this.onFavoriteClick=async()=>{this.trackEvent(i({source:"community_nav",action:"click",noun:this.isFavorited?"unfavorite":"favorite"},this.getTrackingContext()));try{const t={input:{label:this.multiredditPath,favoriteState:this.isFavorited?a.None:a.Favorited}},{data:e}=await s({operation:r.UpdateMultiredditFavoriteState,variables:t});if(e.updateMultiredditFavoriteState?.ok){const t={path:this.multiredditPath,isFavorited:!this.isFavorited};return void this.publish(o.MultiredditFavoriteStatusChange,t)}throw new Error("error updating custom feed favorite status")}catch(t){const e=this.isFavorited?`Failed to remove ${this.displayName} from favorites`:`Failed to add ${this.displayName} to favorites`;this.dispatchEvent(d("faceplate-alert",{level:n.error,message:e}))}}}static get styles(){return[l]}updated(t){}render(){const t=g`<span class="mr-[2px]">${this.iconSrc?g`<img class="rounded-full" loading="lazy" src="${this.iconSrc}" width="32" height="32" aria-hidden="true" alt="custom feed icon">`:F({size:S.Large})}</span>`;return g`<faceplate-tracker source="${"community_nav"}" action="click" noun="custom_feed" data-faceplate-tracking-context="${JSON.stringify(this.getTrackingContext())}">${k({href:this.multiredditPath,innerClassName_DO_NOT_USE:"s:rounded-[8px] bg-transparent",label:g`<div class="truncate">${this.displayName}</div>`,leadingAvatar:t,size:$.Small,trailingSlot:g` ${c({appearance:"plain",leadingIcon:(this.isFavorited?y:b)({size:S.Small}),size:h.Small,attributes:{"aria-label":this.isFavorited?"Remove custom feed from favorites":"Add custom feed to favorites",onclick:t=>{t.preventDefault(),t.stopPropagation(),this.onFavoriteClick()}}})}`})}</faceplate-tracker>`}};p([u({type:String})],w.prototype,"multiredditPath",void 0),p([u({type:String})],w.prototype,"displayName",void 0),p([u({type:String})],w.prototype,"iconSrc",void 0),p([u({type:Boolean})],w.prototype,"isFavorited",void 0),p([u({type:String})],w.prototype,"sanNoun",void 0),w=p([m("left-nav-multireddit-item")],w);class O extends(e(N)){constructor(){super(),this.initialStateJSON="[]",this.items=[],this.triggerReload=()=>{this.dispatchEvent(new CustomEvent(x))},this.updateFavoritedState=({path:t,isFavorited:e})=>{const i=[...this.items],a=i.findIndex((e=>e.path===t));-1!==a&&i[a].isFavorited!==e&&(i[a].isFavorited=e,this.items=_(i))},this.reloadController=new P(this,{reloadUrl:"/svc/shreddit/left-nav-multireddits-section",containerSelector:"left-nav-multireddits-controller",mode:v.Replace})}connectedCallback(){super.connectedCallback(),this.items=_(JSON.parse(this.initialStateJSON)),this.subscribe(o.MultiredditFavoriteStatusChange,this.updateFavoritedState),this.subscribe(o.CustomFeedUpdated,this.triggerReload,!1),this.subscribe(o.CustomFeedCreated,this.triggerReload,!1),this.subscribe(o.CustomFeedDeleted,this.triggerReload,!1)}render(){return g`<div> ${this.reloadController?.isLoading?g`<shreddit-loading></shreddit-loading>`:g`${C(this.items,(t=>g`<left-nav-multireddit-item sanNoun="${this.sanNoun}" multiredditPath="${t.path}" displayName="${t.displayName}" iconSrc="${t.icon}" ?isFavorited="${t.isFavorited}"></left-nav-multireddit-item>`))}`} </div>`}}function _(t){return[...t.sort(((t,e)=>t.isFavorited===e.isFavorited?t.displayName.toLowerCase()>e.displayName.toLowerCase()?1:-1:t.isFavorited?-1:1))]}p([u({type:String})],O.prototype,"initialStateJSON",void 0),p([f()],O.prototype,"items",void 0);let j=class extends O{constructor(){super(...arguments),this.sanNoun="multireddits_menu"}};j=p([m("left-nav-multireddits-controller")],j);
//# sourceMappingURL=left-nav-multireddits-section-client-js-713eb71c.js.map
