import{s as e,x as t}from"./icon-bd54b9fa.js";import{W as s,_ as i,n as a,e as n,E as r,dD as o,dE as l,dz as h,dA as d,dZ as u,g as c,k as m,dy as p,a as g,a8 as w,aB as v,dI as b}from"./shell-091aa980.js";import{l as D}from"./load-lazy-script-with-nonce-91b572d7.js";import{l as y}from"./index-6fdf52be.js";import"./pdp-back-button-8e7390b3.js";import"./faceplate-search-input-99d5be32.js";import"./live-30a71da3.js";import"./faceplate-text-input-5cdbed8e.js";import"./text-input-30412a36.js";import"./form-common-utils-52bc3cfc.js";import"./faceplate-input-1d78f8a0.js";import"./input-element-422d9934.js";const E=s(e),M=e=>{e.preventDefault()};let k=class extends E{constructor(){super(...arguments),this.isHamburgerMenuIncluded=!1,this.showAccountManagerModal=!1,this.hamburgerMenuButton=null,this.menuDialog=null,this.loginButton=void 0,this.shredditInteractableElement=null,this.search=null,this.userDrawerButton=null,this.userDrawerMenu=null,this.userDrawerContent=null,this.userDrawerLoginButton=null,this.advertiseButton=null,this.recapCampaignLink=void 0,this.mScreenMediaQueryList=window.matchMedia?.("(min-width: 1200px)"),this.cachedIsHamburgerMenuShown=!(this.mScreenMediaQueryList?.matches??1),this.events=new r(this),this._track=this.events.define("faceplate-track",(e=>{const{source:t,action:s,noun:i}=e.detail;"nav"===t&&"click"===s&&"create_community"===i&&this._closeDialog()})),this.handleMScreenMediaQueryListChange=({matches:e})=>{e&&this.cachedIsHamburgerMenuShown&&this._closeDialog(),this.cachedIsHamburgerMenuShown=!e},this.handleOpenUserDrawer=e=>{e.stopPropagation(),this._closeDialog(),this.trackEvent(o())},this.handleCloseUserDrawer=e=>{e?.stopPropagation(),this.trackEvent(l())},this.setupUserDrawer=async()=>{this.userDrawerButton=this.querySelector("#expand-user-drawer-button"),this.userDrawerMenu=this.userDrawerButton?.closest("faceplate-dropdown-menu")??null,this.userDrawerContent=this.querySelector("#user-drawer-content")??null},this.focusSearchInput=()=>{this.search?.shadowRoot?.querySelector("faceplate-search-input")?.focus()},this.handleClickHamburgerMenu=async()=>{await this.initializeHamburgerMenuSlottedElements(),this.menuDialog&&(this.menuDialog.open?this._closeDialog():(this._closeUserDrawer(),this.menuDialog.showModal(),this.trackEvent(h())),this.trackEvent(d()))},this.handleSearchDropdownOpen=()=>{this._closeUserDrawer(),this._closeDialog()},this.handleAdvertiseButtonClick=async e=>{const{isAdblockEnabled:t}=await u();if(t){const t=c("faceplate-alert",{level:m.notice,message:"To advertise, disable your ad blocker or add reddit.com as an exception."});e.target?.dispatchEvent(t)}}}get logoutButton(){return this.querySelector("#logout-list-item")}_closeDialog(){this.menuDialog?.open&&(this.menuDialog.hide(),this.reset(),this.trackEvent(p()))}_closeUserDrawer(){this.userDrawerMenu?.hidden||this.userDrawerMenu?.close()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListenersFromSlottedElements()}addEventListenersToSlottedElements(){this.mScreenMediaQueryList?.addEventListener("change",this.handleMScreenMediaQueryListChange),this.userDrawerMenu?.addEventListener("faceplate-dropdown-menu:open",this.handleOpenUserDrawer),this.userDrawerMenu?.addEventListener("faceplate-dropdown-menu:close",this.handleCloseUserDrawer),this.advertiseButton?.addEventListener("click",this.handleAdvertiseButtonClick)}removeEventListenersFromSlottedElements(){this.mScreenMediaQueryList?.removeEventListener("change",this.handleMScreenMediaQueryListChange),this.userDrawerMenu?.removeEventListener("faceplate-dropdown-menu:open",this.handleOpenUserDrawer),this.userDrawerMenu?.removeEventListener("faceplate-dropdown-menu:close",this.handleCloseUserDrawer)}async initializeHamburgerMenuSlottedElements(){this.isHamburgerMenuIncluded&&(this.menuDialog||(this.menuDialog=this.shadowRoot?.querySelector("slot[name=reddit-header-hamburger-menu]")?.assignedElements({flatten:!0})?.find((e=>e.matches("rpl-dialog#menu")))??null))}initializeSlottedElements(){!this.loginButton&&this.showAccountManagerModal&&(this.loginButton=this.querySelector("a#login-button"),this.loginButton?.addEventListener("click",M)),!this.userDrawerLoginButton&&this.showAccountManagerModal&&(this.userDrawerLoginButton=this.querySelector("#login-list-item"),this.userDrawerLoginButton?.addEventListener("click",(e=>{e.preventDefault(),this._closeUserDrawer()}))),this.search||(this.search=this.querySelector("reddit-search-large"),this.search?.addEventListener("reddit-search:open",this.handleSearchDropdownOpen)),this.userDrawerButton||this.setupUserDrawer(),this.advertiseButton||(this.advertiseButton=this.querySelector("#advertise-button")),!this.recapCampaignLink&&this.loginButton&&(this.recapCampaignLink=this.querySelector("a#recap-entrypoint"),this.recapCampaignLink?.addEventListener("click",M))}reset(){this.menuDialog?.scrollTo(0,0)}static get styles(){return[g]}firstUpdated(){this.initialize()}async initialize(){this.hamburgerMenuButton||(this.hamburgerMenuButton=this.querySelector("#navbar-menu-button"),this.hamburgerMenuButton?.addEventListener("click",this.handleClickHamburgerMenu)),this.initializeSlottedElements(),this.addEventListenersToSlottedElements(),this.logoutButton?.addEventListener("click",y),this.logoutButton&&D(`script#${w}`)}render(){return t` <shreddit-async-loader bundleName="reddit_search_large"></shreddit-async-loader> ${this.isHamburgerMenuIncluded?t`<slot class="v2" name="reddit-header-hamburger-menu"></slot>`:""} <slot class="v2" name="reddit-search-dialog"></slot> <slot></slot> `}};var S;i([a({type:Boolean,attribute:"is-hamburger-menu-included"})],k.prototype,"isHamburgerMenuIncluded",void 0),i([a({type:Boolean,attribute:"show-accountmanager-modal"})],k.prototype,"showAccountManagerModal",void 0),k=i([n("reddit-header-large")],k);let C=S=class extends e{constructor(){super(...arguments),this.activationIsEnabled=!1,this.onChatButtonClick=()=>{this.toggleUIState()},this.onChatButtonKeyDown=e=>{"Enter"!==e.key&&" "!==e.key||this.toggleUIState()}}getChatClientHost(){return document.querySelector("reddit-chat-host")}async activateFeature(){try{await v({name:b})}catch(e){if(!e.message?.endsWith(`${b} not found`))throw e}}async setUIState(){if(S.hasInitialized)return;S.hasInitialized=!0;const e=this.initialView;if(!e)return;this.activationIsEnabled&&await this.activateFeature(),await window.customElements.whenDefined("reddit-chat-host");const t=this.getChatClientHost();t&&t.setUIState?.(e)}async toggleUIState(){await this.activateFeature();const e=this.getChatClientHost();e&&e.toggleUIState?.()}connectedCallback(){super.connectedCallback(),this.addEventListener("click",this.onChatButtonClick),this.addEventListener("keydown",this.onChatButtonKeyDown),this.setUIState()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("click",this.onChatButtonClick),this.removeEventListener("keydown",this.onChatButtonKeyDown)}render(){return t`<slot></slot>`}};C.hasInitialized=!1,i([a({type:Boolean,attribute:"activation-enabled"})],C.prototype,"activationIsEnabled",void 0),i([a({type:String,attribute:"initial-view"})],C.prototype,"initialView",void 0),C=S=i([n("reddit-chat-header-button")],C);
//# sourceMappingURL=header-large-client-js-3d4531f6.js.map
